<!DOCTYPE html> <html>
<head>
    <style>
        
        /*Card Style for classes*/
        .card {
            box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
            transition: 0.3s;
            width: 400px;
            height: 450px;
            border-radius: 5%;
            padding: 2%;
            background-color: #4edde5;
        }

        .card:hover {
            box-shadow: 0 8px 16px 0 rgba(0,0,0,0.5);
            cursor: pointer;
        }

        .img {
             width: 250px;
            height: 250px;
            margin-right: auto;
            margin-left: auto;
            display:block;
            border-radius: 50%;
            overflow: hidden;
            padding:5px 4px;
        
        }

        .container {
            padding: 2px 16px;
        }    
    </style>
    <script src="https://www.gstatic.com/firebasejs/4.10.0/firebase.js"></script>
    <script>
        class Note {
            constructor(name, des) {
                this.name = name;
                this.des = des;
            }
        }
    </script>
    <script>
        //resources http://materializecss.com/getting-started.html
        
        
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyBYn0-u-4jrsWB1f0TjnzSrb9rwujjO9Vk",
        authDomain: "tinovation-data.firebaseapp.com",
        databaseURL: "https://tinovation-data.firebaseio.com",
        projectId: "tinovation-data",
        storageBucket: "tinovation-data.appspot.com",
        messagingSenderId: "438853586812"
      };
      firebase.initializeApp(config);
        
        var database = firebase.database();
        var classroomParent = database.ref().child("Classrooms");
        
        var classes = {};
        //loops through the classes
        //finds the notes and adds them in
        function updateNotes(callback) {
            classroomParent.ref.once("value")
                .then(function(snapshot) {
                snapshot.forEach(function(childSnapShot) {
                    var key = childSnapShot.key;
                    var val = childSnapShot.val();

                    var notes = [];
                    childSnapShot.forEach(function (child2SnapShot){
                        var n = new Note(child2SnapShot.key, 
                                        child2SnapShot.val());
                       notes.push(n);
                    });
                    classes[key] = notes;
                });
            });
            callback && callback();
        }
        function addToFireBase(cN, nN, nD) {
            console.log(cN + " " + nN + " " + nD);
            var updates = {};
            updates['/Classrooms/' + cN + '/' + nN] = nD; 
            database.ref().update(updates);
            updateNotes();
        }
        
    </script>
   <!-- <script src="jquery-3.3.1.min.js"></script>-->
    
    <script>
        var notFinishedText;
        var className;
        var noteName;
        var noteDes;
        function init() {
            notFinishedText = document.getElementById("NotFinishedText");
            className = document.getElementById("className");
            noteName = document.getElementById("noteName");
            noteDes = document.getElementById("description");
            updateNotes(function() {
                setTimeout(function() {
                    displayNotes();
                }, 1000);
            });
            
        }
        
        function makeNewNote() {
            if (className.value.length == 0 ||
               noteName.value.length == 0 ||
               noteDes.value.length == 0) {
                notFinishedText.style.visibility = "visible";
            } else{
                var cN = className.value;
                var nN = noteName.value;
                var nD = noteDes.value;
                
                addToFireBase(cN, nN, nD);
                
                notFinishedText.style.visibility = "collapse";
            }
        }
        
       
        function displayNotes() {
            document.getElementById("ClassDisplay").innerHTML = "";
            for (var className in classes) {
                var div = document.createElement("div");
               // div.style.width = "25%";
            //    div.style.height = "25%";
                div.style.textalign = "center";
            
               // div.style.align = "center";
                div.className = "card";
                div.onmousedown = function() {
                    var classN = this.childNodes[1].childNodes[0].innerHTML;
                   // console.log(classes[classN]);
                    for (var n in classes[classN]) {
                        var note = classes[classN][n];
                        console.log(classN + "\n\t" + note.name + "\n\t\t" + note.des);
                        //console.log(note.des);
                    }
                }
                
                
                
                var cardImg = document.createElement("img");
                cardImg.setAttribute("src", "Notely_Res/History_Room_Image.jpg");
                //cardImg.setAttribute("width", "50%");
                //cardImg.setAttribute("height", "50%");
                cardImg.setAttribute("alt", "Image");
                //cardImg.style.align = "center";
                //cardImg.style.borderRadius = "50%";
                cardImg.className = "img";
                div.append(cardImg);
                
                
                var containerForDescription = document.createElement("div");
                containerForDescription.className = "container";
                div.append(containerForDescription);
                
                var classNameText = document.createElement("h4");
                classNameText.innerHTML = className;
                classNameText.style.textAlign = "center"; 
                var classRoomDescription = document.createElement("p");
                classRoomDescription.innerHTML = "Class description (Click to view notes)";
                
                containerForDescription.append(classNameText);
                containerForDescription.append(classRoomDescription);
                
                
                /*
                var div = document.createElement("div");
                div.style.lineHeight = "0%";
                div.style.width = "25%";
                
                var classNameText = document.createElement("p");
                classNameText.innerHTML = className;
                classNameText.style.color = "red";
                
                div.append(classNameText);
                
                var noteArr = classes[className];
                for (var i in noteArr) {
                    //n - note name
                    //d - note description
                    var n = document.createElement("p");
                    var d = document.createElement("p");
                    n.innerHTML = noteArr[i].name; n.style.textAlign = "center";
                    d.innerHTML = noteArr[i].des; d.style.textAlign = "center";
                    
                    div.append(n);
                    div.append(d);
                    
                }*/
                
               
                document.getElementById("ClassDisplay").append(div);
                document.getElementById("ClassDisplay").append(document.createElement("br"));
                document.getElementById("ClassDisplay").append(document.createElement("br"));
                
            }
        }     
    </script>
    </head>
    <body onload="init()">
        <br><br>
        <!--<div align="center">
            Class:<br>
            <input type="text" id="className" value="class_name"><br>
            Note Title:<br>
            <input type="text" id="noteName" value="note_title"><br>
            Notes:<br>
            <textarea id="description" rows="5" cols="40">Today I learned...</textarea><br>
            <button onclick="makeNewNote()" id="newNoteButton">Create!</button>
        </div>
        <div align="center">
            <p style="color:red; visibility: collapse" id="NotFinishedText">Fill in all the fields!</p>
        </div>-->
        <br><br>
        <button onclick="displayNotes()">Display Notes</button>
        <div id="ClassDisplay" style="width: 100%">
        </div>
    </body>
    
    
    
</html>